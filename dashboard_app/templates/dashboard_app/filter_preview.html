{% extends "dashboard_app/_content.html" %}
{% load i18n %}
{% load django_tables2 %}

{% block extrahead %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}dashboard_app/css/filter-edit.css" />
{{ block.super }}
<script type="text/javascript" src="{% url admin:jsi18n %}"></script>
<script type="text/javascript">
var django = {};
django.jQuery = $;
var test_case_url = "{% url dashboard_app.views.filter_add_cases_for_test_json %}?test=";
var attr_name_completion_url = "{% url dashboard_app.views.filter_attr_name_completion_json %}";
var attr_value_completion_url = "{% url dashboard_app.views.filter_attr_value_completion_json %}";
</script>
{{ form.media }}
<script type="text/javascript" src="{{ STATIC_URL }}dashboard_app/js/filter-edit.js"></script>
{% endblock %}

{% block content %}
{% if form.instance.pk %}
<h1>Previewing changes to filter &ldquo;{{ form.instance.name }}&rdquo;</h1>
{% else %}
<h1>Previewing new filter &ldquo;{{ form.name.value }}&rdquo;</h1>
{% endif %}

{% include "dashboard_app/filter_summary.html" with summary_data=form.summary_data %}

<p>
  These are the results matched by your filter.
</p>

{% render_table table %}

<p>

<form action="" method="post">
  <p>
    If this is what you expected, you can
    {% if form.instance.pk %}
    <input type="submit" name="save" value="save changes"> to the filter.
    {% else %}
    <input type="submit" name="save" value="save"> the filter.
    {% endif %}
  </p>
  <p>
    Otherwise, you can <a href="#" id="edit-link">edit</a> it.
  </p>
  {% csrf_token %}
  <div id="filter-edit" style="display: none">
    {% include "dashboard_app/filter_form.html" %}
    <input type="submit" name="preview" value="Preview again">
  </div>
</form>


<script type="text/javascript">
$("#edit-link").click(function (e) {
e.preventDefault();
$("#filter-edit").show();
});
</script>
{% endblock %}
