{% extends "layouts/content_with_sidebar.html" %}
{% load i18n %}


{% block extrahead %}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}lava-server/css/demo_table_jui.css"/>
<script type="text/javascript" src="{{ STATIC_URL }}lava-server/js/jquery.dataTables.min.js"></script> 
{% endblock %}


{% block title %}{{ block.super }} | {% trans "API" %} | {% trans "Authentication Tokens" %}{% endblock %}


{% block breadcrumbs %}
{{ block.super }}
<li><a href="{% url lava.home %}">{% trans "LAVA" %}</a></li>
<li>{% trans "API" %}</a></li>
<li><a
  href="{% url linaro_django_xmlrpc.views.tokens %}"
  >{% trans "Authentication Tokens" %}</a></li>
{% endblock %}


{% block sidebar %}
<h3>Actions</h3>
<ul>
  <li><a href="{% url linaro_django_xmlrpc.views.create_token %}">Create new token</a></li>
</ul>
{% endblock %}


{% block content %}
<h2>Authentication Tokens</h2>
<p>Authentication tokens allow scripts using <a
  href="https://launchpad.net/lava-tool">lava-tool</a> to securely access LAVA
resources. You can create and use any number of tokens simultaneously. If you
believe a token is compromised you can quickly remove it.  Anyone using that
token will no longer be able to authenticate as You in the system.</p>
<h2>Your tokens</h2>
{% for token in token_list %}
<h3>Token No. {{ token.pk }}</h3>
<dl>
  <dt>Description:</dt>
  <dd><a 
    href="{% url linaro_django_xmlrpc.views.edit_token token.pk %}"
    >{{token.description|default:"empty"}}</a></dd>
  <dt>Created on:</dt>
  <dd>{{token.created_on|date}}</dd>
  <dt>Last used:</dt>
  <dd>
  {% if token.last_used_on %}
  {{token.last_used_on|timesince }} ago
  {% else %}
  <em>It was not used yet</em>
  {% endif %}
  </dd>
  <dt>Secret:</dt>
  <dd>
  <span id="notice_{{ forloop.counter }}">The secret is currently hidden.</span>
  <div class="console" style="display:none;" id="secret_{{ forloop.counter }}">
    <code>{{ token.secret }}</code>
  </div>
  </dd>
</dl>
<ul>
  <li><a
    href="#" 
    id="button_{{ forloop.counter }}"
    >display this token</a></li>
  <li><a 
    href="{% url linaro_django_xmlrpc.views.delete_token token.pk %}"
    >delete this token</a></li>
</ul>
<script type="text/javascript">
  $("#button_{{ forloop.counter }}").click(function() {
    $("#secret_{{ forloop.counter }}").toggle();
    $("#notice_{{ forloop.counter }}").toggle();
  });
</script>
{% empty %}
<p>You don't have any tokens yet.</p>
{% endfor %}
{% endblock %}
