{% extends "lava_scheduler_app/_content.html" %}


{% block content %}
<h2>All Jobs</h2>

<table class="data display">
  <thead>
    <tr>
      <th class="id">ID</th>
      <th class="status">Status</th>
      <th class="device">Device</th>
      <th class="description">Description</th>
      <th class="submitter">Submitter</th>
      <th class="submit_time">Submit Time</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<script>
$(document).ready(
  function() {
    $("table.data").dataTable({
      bJQueryUI: true,
      bServerSide: true,
      bProcessing: true,
      bFilter: false,
      sAjaxSource: "{% url lava_scheduler_app.views.alljobs_json %}",
      aaSorting: [[0, "desc"]],
      iDisplayLength: 25,
      aoColumnDefs: [
        {
          aTargets: ["id"],
          fnRender: function (o) { return '<a href="' + o.aData.id.link + '">' + o.aData.id.id + '</a>'; }
        },
        {
          aTargets: ["device"],
          fnRender: function (o) {
            o = o.aData;
            if (o.actual_device) {
              return '<a href="' + o.actual_device.link + '">' + o.actual_device.name + '</a>';
            } else if (o.requested_device) {
              return '<i>' + o.requested_device + '</i>';
            } else {
              return '<i>' + o.requested_device_type + '</i>';
            }
         }
        }
      ]
    });
  }
);
</script>

{% endblock %}
